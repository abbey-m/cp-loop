<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>what should i wear for cp loop today?</title>
  <meta name="description" content="Tiny site that checks New York City's weather right now and tells you what to wear for a bike ride." />
  <style>
    /* ===== Typography =====
       NOTE: Canela is a licensed typeface by Miguel Reyes / Commercial Type.
       Replace the src URL below with your licensed file(s) or a hosted kit.
       The file names are placeholders. */
    @font-face {
      font-family: 'Canela';
      src: url('./Canela-Regular.woff2') format('woff2'),
           url('./Canela-Regular.woff') format('woff');
      font-weight: 400;
      font-style: normal;
      font-display: swap;
    }

    :root {
      --bg: #FAF7F2;
      --ink: #1f2937;        /* neutral-800 */
      --muted: #6b7280;      /* neutral-500 */
      --card: #ffffffcc;     /* translucent white */
      --border: #e5e7eb;     /* neutral-200 */
      --accent: #111827;     /* neutral-900 for strong text */
      --radius: 18px;
      --shadow: 0 8px 30px rgba(0,0,0,0.07);
    }

    html, body {
      height: 100%;
    }

    body {
      margin: 0;
      background: var(--bg);
      color: var(--ink);
      font-family: 'Canela', ui-serif, Georgia, Cambria, "Times New Roman", Times, serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      letter-spacing: 0.2px;
    }

    .wrap {
      min-height: 100%;
      display: grid;
      place-items: center;
      padding: 32px;
    }

    .card {
      width: 100%;
      max-width: 820px;
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(6px);
      padding: 28px 28px 22px;
    }

    header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      gap: 12px;
      border-bottom: 1px dashed var(--border);
      padding-bottom: 18px;
      margin-bottom: 18px;
    }

    h1 {
      font-size: clamp(28px, 4vw, 40px);
      line-height: 1.05;
      margin: 0;
      color: var(--accent);
    }

    .when {
      font-size: 14px;
      color: var(--muted);
      white-space: nowrap;
    }

    .grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 18px;
    }

    @media (min-width: 720px) {
      .grid {
        grid-template-columns: 1.2fr 1fr;
        gap: 24px;
      }
    }

    .panel {
      background: #fff;
      border: 1px solid var(--border);
      border-radius: calc(var(--radius) - 6px);
      padding: 18px 18px 16px;
    }

    .kicker {
      font-size: 13px;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 0.12em;
      margin-bottom: 8px;
    }

    .temp {
      font-size: clamp(48px, 10vw, 96px);
      line-height: 0.95;
      margin: 6px 0 2px;
      font-variant-numeric: tabular-nums;
    }

    .wind {
      font-size: 18px;
      color: var(--ink);
      margin: 6px 0 0;
    }

    .advice {
      font-size: clamp(18px, 2.2vw, 22px);
      line-height: 1.3;
      margin: 4px 0 0;
    }

    .note {
      margin-top: 14px;
      font-size: 13px;
      color: var(--muted);
    }

    .footer {
      margin-top: 20px;
      border-top: 1px dashed var(--border);
      padding-top: 14px;
      display: flex;
      flex-wrap: wrap;
      gap: 10px 16px;
      align-items: center;
      justify-content: space-between;
      font-size: 13px;
      color: var(--muted);
    }

    button.refresh {
      appearance: none;
      border: 1px solid var(--border);
      background: #ffffff;
      padding: 8px 12px;
      border-radius: 999px;
      cursor: pointer;
      font-family: inherit;
      transition: transform .05s ease, box-shadow .2s ease;
      box-shadow: 0 3px 12px rgba(0,0,0,.04);
    }

    button.refresh:active { transform: translateY(1px); }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <header>
        <h1>cp loop status</h1>
        <div class="when" id="when">—</div>
      </header>

      <div class="grid">
        <section class="panel">
          <div class="kicker">Right now in New York City</div>
          <div class="temp" id="temp">—</div>
          <div class="wind" id="wind">—</div>
        </section>

        <section class="panel">
          <div class="kicker">What to Wear</div>
          <div class="advice" id="advice">—</div>
          <p class="note">Enter additional info</p>
        </section>
      </div>

      <div class="footer">
        <div>
          Data via Open‑Meteo • Units: °F & mph • Timezone: America/New_York
        </div>
        <button class="refresh" id="refreshBtn" title="Refresh weather">Refresh</button>
      </div>
    </div>
  </div>

  <script>
    const NYC = { lat: 40.7128, lon: -74.0060 };
    const API = `https://api.open-meteo.com/v1/forecast?latitude=${NYC.lat}&longitude=${NYC.lon}&current=temperature_2m,wind_speed_10m,wind_gusts_10m&temperature_unit=fahrenheit&wind_speed_unit=mph&timezone=America%2FNew_York`;

    const $temp = document.getElementById('temp');
    const $wind = document.getElementById('wind');
    const $advice = document.getElementById('advice');
    const $when = document.getElementById('when');
    const $refresh = document.getElementById('refreshBtn');

    function formatWhen(date = new Date()) {
      const fmt = new Intl.DateTimeFormat('en-US', {
        weekday: 'long', month: 'long', day: 'numeric', year: 'numeric',
        hour: 'numeric', minute: '2-digit', hour12: true,
        timeZone: 'America/New_York'
      });
      return fmt.format(date);
    }

    function windLabel(speedMph, tempF) {
      // Per your table, the wind descriptor is tied to the temp band.
      // If it is below 30°F, use "Bitter" regardless of speed.
      if (tempF < 30) return 'Bitter';
      if (speedMph < 8) return 'Light';
      if (speedMph < 16) return 'Moderate';
      if (speedMph < 21) return 'Breezy';
      if (speedMph < 28) return 'Blustery';
      return 'Gusty';
    }

    function wearAdvice(tempF) {
      if (tempF >= 70) {
        return "Shorts & T‑shirt (ish): Go for the classic shorts and a short‑sleeve jersey. Don't forget your shades and sunscreen!";
      } else if (tempF >= 60) {
        return "Arm/Knee Warmers & Vest: Shorts are still on the menu! Add arm warmers and a light vest for when the breeze hits.";
      } else if (tempF >= 50) {
        return "Tights & Long Sleeves: Time to cover those knees! Tights, a long‑sleeve top, light gloves, and maybe an ear‑covering headband.";
      } else if (tempF >= 40) {
        return "Thermal Gear & Layers: Bring out the thermal tights and a proper cycling jacket. Medium gloves, wool socks, and a headband are a must.";
      } else if (tempF >= 30) {
        return "Heavy Armor: Heavy insulated gear, a buff for your face, and beefy mittens. Stay warm out there!";
      } else {
        return "Full Insulation: This is serious business. Double layers, a hefty buff, goggles, and heated gear if you have it!";
      }
    }

    async function load() {
      try {
        $when.textContent = formatWhen();
        const res = await fetch(API, { cache: 'no-store' });
        if (!res.ok) throw new Error('Weather fetch failed');
        const data = await res.json();
        const t = data?.current?.temperature_2m;
        const ws = data?.current?.wind_speed_10m;
        const wg = data?.current?.wind_gusts_10m;

        if (typeof t !== 'number' || typeof ws !== 'number') {
          throw new Error('Missing current weather fields');
        }

        const roundedT = Math.round(t);
        const windText = `${Math.round(ws)} mph` + (typeof wg === 'number' ? ` (gusts ~${Math.round(wg)} mph)` : '');
        const label = windLabel(ws, t);

        $temp.textContent = `${roundedT}°F`;
        $wind.textContent = `Wind: ${label} — ${windText}`;
        $advice.textContent = wearAdvice(t);
      } catch (err) {
        console.error(err);
        $temp.textContent = '—';
        $wind.textContent = 'Aww snap, could not load weather. Try Refresh.';
        $advice.textContent = '—';
      }
    }

    $refresh.addEventListener('click', load);
    load();
  </script>
</body>
</html>